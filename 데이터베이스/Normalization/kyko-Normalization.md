## 정규화란?

정규화(Normalization)란 관계형 데이터베이스 설계에서 데이터의 중복을 최소화하고 구조를 효율적으로 구성하는 프로세스를 말한다. 쉽게 말해서, 잠재적인 문제가 발생하지 않도록 테이블의 필드를 구성하고, 필요한 경우 테이블을 나누는 작업을 의미한다.

정규화된 테이블의 형태를 **정규형(Normal Form, NF)** 이라고 하며, 정규형의 종류에는 제 1 정규형(1NF), 제2 정규형(2NF), 제3 정규형(3NF), 보이스/코드 정규형(BCNF), 제4 정규형(4NF), 제5 정규형(5NF) 등이 있다. 일반적으로는 제3 정규형 또는 보이스/코드 정규형까지만 수행되며, 3NF 테이블의 경우 대부분 삽입, 변경, 삭제 이상이 발생하지 않는다.

각 정규형을 생성하는 **정규화**는 일종의 규칙으로, 데이터베이스의 무결성과 효율성을 높이는 데 기여한다.

## 정규화는 왜 필요할까?

수강 신청 관련 테이블이 다음과 같이 설계되었다고 가정해보자

| 학번 | 이름 | 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- | --- | --- |
| 1 | 고경남 | CS 100 | 데이터베이스 | 김XX |
| 2 | 강희준 | CS 200 | 운영체제 | 이XX |
| 3 | 백효석 | CS 100 | 데이터베이스 | 김XX |
| … | … | … | … | … |

위의 테이블에서 데이터베이스 과목의 담당 교수를 박XX 교수로 변경하려면 과목 코드가 CS 100인 모든 행을 수정해야 한다. 이처럼 모든 행을 일일이 수정해야 하는 상황은 비효율적이다.

이와 같은 문제 외에도 데이터베이스를 잘못 설계할 경우, 불필요한 데이터 중복으로 인해 공간 낭비 및 여러 부작용이 발생할 수 있다. 이러한 부작용을 **이상(Anomaly)** 라고 한다.

이상 현상의 종류에는 삽입 이상, 갱신 이상, 삭제 이상이 있다.

## 이상 현상

다음은 학생 정보와 과목 정보를 포함한 테이블이다.

| 학번(PK) | 학년 | 이름 | 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- | --- | --- | --- |
| 1 | 2 | 고경남 | CS 101 | 컴퓨터 구조 | 김XX |
| 2 | 4 | 강희준 | CS 102 | 데이터베이스 | 이XX |
| 3 | 3 | 백효석 | CS 103 | 자료구조 | 박XX |

이 테이블에서 발생할 수 있는 이상 현상은 다음과 같다.

**1. 삽입 이상(Insertion Anomaly)**

새로운 과목인 운영체제를 추가하고 싶을 때, 해당 과목에 대한 학생 정보가 없다면 추가할 수 없다. 이는 기본키인 학번이 필수적으로 요구되기 때문이다. 이러한 상황을 삽입 이상이라고 부른다.

**2. 삭제 이상(Deletion Anomaly)**

고경남이 수강 신청 취소하여 테이블에서 고경남 정보를 삭제하게 되면, 컴퓨터 구조 과목에 대한 정보도 함께 삭제되는 상황이 발생한다. 이러한 상황을 삭제 이상이라고 부른다.

**3. 갱신 이상(Update Anomaly)**

갱신 이상은 데이터의 일관성을 해치는 문제이다. 예를 들어, "컴퓨터 구조"라는 과목의 이름을 변경하고자 할 때, 위 테이블에 있는 모든 "컴퓨터 구조" 과목 이름을 수정해야 한다. 만약 일부만 변경되고 다른 부분은 그대로 남아있다면 데이터 불일치가 발생하게 된다. 이러한 상황을 갱신 이상이라고 한다.

이러한 이상 현상을 방지하기 위해 정규화를 통해 데이터 구조를 개선하고, 데이터 중복을 최소화하는 것이 중요하다.

## 제1 정규형(1NF)

제1 정규형(1NF)을 만족하기 위한 필요충분조건은 **모든 속성이 원자 값**을 가져야 한다는 것이다. 즉, 각 테이블의 필드는 더 이상 쪼개질 수 없는 단일 값을 가져야 한다.

| 학번 | 이름 | 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- | --- | --- |
| 1 | 고경남 | CS 100, CS 200 | 데이터베이스, 운영체제 | 김XX, 이XX |
| 2 | 강희준 | CS 200, CS 300 | 운영체제, 자료구조 | 이XX, 고XX |
| 3 | 백효석 | CS 100, CS 400 | 데이터베이스, 네트워크 | 김XX, 강XX |
| … | … | … | … | … |

위의 형태는 제 1정규형을 만족하지 않는다. 이를 제1 정규형에 맞추어 설계하면 다음과 같다.

| 학번 | 이름 | 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- | --- | --- |
| 1 | 고경남 | CS 100 | 데이터베이스 | 김XX |
| 1 | 고경남 | CS 200 | 운영체제 | 이XX |
| 2 | 강희준 | CS 200 | 운영체제 | 이XX |
| 2 | 강희준 | CS 300 | 자료구조 | 고XX |
| 3 | 백효석 | CS 100 | 데이터베이스 | 김XX |
| 3 | 백효석 | CS 400 | 네트워크 | 강XX |

## 제2 정규형(2NF)

제2 정규형(2NF)을 만족하기 위한 필요충분조건은 제 1정규형을 만족함과 동시에, 기본 키가 아닌 모든 필드가 기본 키에 완전히 종속되어야 한다는 것이다. 이는 기본 키가 2개 이상의 필드로 구성될 때 고려된다.

> 특정 필드 X의 값을 통해 특정 필드 Y의 유일한 값이 결정될 경우 ‘**Y가 X에 종속적**’라고 표현한다. 이때 X를 결정자, Y를 종속자라고 한다.
> 

기본 키가 아닌 필드가 기본 키의 일부에 종속되어 있는 경우 **부분 함수 종속성(partial functional dependency)** 이 있다고 표현하고, 기본 키 전체에 완전하게 종속되어 있는 경우 **완전 함수 종속성(full functional dependency)** 이 있다고 표현한다.

즉, 제2 정규형은 부분 함수 종속성이 없는 상태이다.

| 학번 | 이름 | 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- | --- | --- |
| 1 | 고경남 | CS 100 | 데이터베이스 | 김XX |
| 1 | 고경남 | CS 200 | 운영체제 | 이XX |
| 2 | 강희준 | CS 200 | 운영체제 | 이XX |
| 2 | 강희준 | CS 300 | 자료구조 | 고XX |
| 3 | 백효석 | CS 100 | 데이터베이스 | 김XX |
| 3 | 백효석 | CS 400 | 네트워크 | 강XX |

위 테이블에서 ‘담당 교수’ 및 ‘과목 이름’은 과목 코드에 종속적이지만, 학번과는 아무런 관계가 없다. 그러므로 제2 정규형을 만족하지 않는다. 이를 만족하기 위해서는 테이블을 아래와 같이 분할해야 한다.

| 학번 | 이름 | 과목 코드 |
| --- | --- | --- |
| 1 | 고경남 | CS 100 |
| 1 | 고경남 | CS 200 |
| 2 | 강희준 | CS 200 |
| 2 | 강희준 | CS 300 |
| 3 | 백효석 | CS 100 |
| 3 | 백효석 | CS 400 |

| 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- |
| CS 100 | 데이터베이스 | 김XX |
| CS 200 | 운영체제 | 이XX |
| CS 300 | 자료구조 | 고XX |
| CS 400 | 네트워크 | 강XX |

## 제3 정규형(3NF)

제3 정규형(3NF)의 필요충분조건은 제2 정규형을 만족하면서, 기본 키가 아닌 모든 필드가 기본 키에 이행적 종속성이 없는 상태를 가진다는 것이다.

이행적 종속성은 특정 필드 X가 Y를 결정하고, Y가 Z를 결정할 때, X가 Z를 결정하는 경우를 의미한다.

| 과목 코드 | 과목 이름 | 담당 교수 |
| --- | --- | --- |
| CS 100 | 데이터베이스 | 김XX |
| CS 200 | 운영체제 | 이XX |
| CS 300 | 자료구조 | 고XX |
| CS 400 | 네트워크 | 강XX |

예를 들어, 과목 코드가 과목 이름을 결정하고, 과목 이름이 담당 교수를 결정한다면, 과목 코드가 담당 교수도 결정하게 된다. 이 경우 과목 코드와 담당 교수는 이행적 종속 관계에 있다.

제3 정규형을 만족하기 위해서는 테이블을 아래와 같이 분할해야 한다.

| 과목 코드 | 과목 이름 |
| --- | --- |
| CS 100 | 데이터베이스 |
| CS 200 | 운영체제 |
| CS 300 | 자료구조 |
| CS 400 | 네트워크 |

| 과목 이름 | 담당 교수 |
| --- | --- |
| 데이터베이스 | 김XX |
| 운영체제 | 이XX |
| 자료구조 | 고XX |
| 네트워크 | 강XX |

## 정규화를 하는게 무조건 좋을까?

정규화를 통해 데이터베이스의 구조를 개선하고 이상 현상을 줄이는 것은 분명 장점이지만, 무조건적으로 좋다고 할 수는 없다.

정규화를 거듭하면 테이블은 점점 쪼개지는 경향이 있으며, 테이블이 많아지면 데이터를 조회할 때 조인 연산이 필요하게 된다. 조인 연산은 성능에 영향을 미칠 수 있으며, 대량의 데이터를 처리할 때는 특히 성능 저하가 발생할 수 있다.

NoSQL 데이터베이스의 경우 성능상의 이점을 최대한 활용하고자 기본적으로 정규화를 하지 않는다. 이 경우 어느 정도의 데이터 중복과 삽입/수정/삭제 연산에서의 번거로움을 감수한다. 하지만 대량의 비정형 데이터를 처리하는 데 유리하다.

검색의 속도를 높이기 위해 분할되어 있는 데이터를 하나로 합치는 작업을 가리켜 **역정규화(denormalizatioin)** 이라고 한다.
