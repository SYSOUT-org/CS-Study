# 트랜잭션

트랜잭션은 단일한 논리적인 작업 단위로, 데이터베이스와 어플리케이션 간의 데이터 거래에 있어서 안정성을 확보하기 위한 방법입니다.

계좌 이체 과정에서 인출 또는 입금만 성공하게 되면 치명적인 문제가 발생할 수 있습니다. 이러한 상황을 방지하기 위해 트랜잭션을 사용합니다. 트랜잭션은 모든 작업이 성공적으로 완료되거나, 실패 시 모든 작업이 원래 상태로 되돌려지는 원자성을 보장합니다. 이를 통해 데이터의 일관성과 무결성을 유지할 수 있습니다.

## 명령어

- **MySQL**에서는 `START TRANSACTION` 명령어를 통해 트랜잭션을 시작하고, `COMMIT` 명령어를 통해 지금까지 작업한 내용을 DB에 저장하고 트랜잭션을 종료합니다.
- `ROLLBACK` 명령어를 사용하면 현재까지의 작업(마지막 커밋 전까지)을 취소하고 트랜잭션 이전 상태로 되돌린 후 트랜잭션을 종료합니다.

- **Spring**에서는 `@Transactional` 어노테이션을 통해 메서드 내의 모든 데이터베이스 작업을 하나의 트랜잭션으로 묶어 처리할 수 있습니다.

## ACID – 트랜잭션이 지녀야 하는 속성

1. **Atomicity (원자성)**:
    - 트랜잭션을 구성하는 연산 전체가 모두 정상 실행되거나 모두 취소되어야 합니다.
    - **ALL or NOTHING**

2. **Consistency (일관성)**:
    - 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 유지해야 합니다.
    - 트랜잭션은 DB 상태를 Consistent 상태에서 또 다른 Consistent 상태로 바꿔주어야 합니다.
    - 트랜잭션이 DB에 정의된 규칙을 위반했다면 해당 트랜잭션은 ROLLBACK 되어야 합니다.
    - **예**: 계좌에 10만원이 있는데 100만원을 이체하려고 하는 경우 수행되면 안됨.

3. **Isolation (고립성)**:
    - 두 개 이상의 트랜잭션이 동시에 발생할 때, 서로의 연산에 영향을 주면 안 됩니다.

4. **Durability (영구성)**:
    - 커밋된 트랜잭션의 내용은 영구히 반영됩니다.
